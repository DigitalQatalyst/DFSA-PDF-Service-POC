# Server Configuration
NODE_ENV=development
PORT=3001

# Azure AD Authentication
AZURE_TENANT_ID=your-tenant-id-here
AZURE_CLIENT_ID=your-client-id-here
AZURE_CLIENT_SECRET=your-client-secret-here

# Dataverse Configuration
DATAVERSE_URL=https://your-org.crm.dynamics.com
DATAVERSE_API_VERSION=v9.2

# Power Pages Configuration (for CORS)
POWER_PAGES_URL=https://your-dfsa-portal.powerappsportals.com

# Security
ALLOWED_ORIGINS=http://localhost:3000,https://your-dfsa-portal.powerappsportals.com

# Logging
LOG_LEVEL=debug

# Rate Limiting
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=10

# ======================================
# PDF Generation Configuration
# ======================================

# Template Configuration
TEMPLATES_PATH=./src/templates

# PDF Conversion Engine (graph or libreoffice)
PDF_CONVERSION_ENGINE=graph

# Microsoft Graph API (for PDF conversion - uses same Azure AD app or separate)
GRAPH_TENANT_ID=your-tenant-id-here
GRAPH_CLIENT_ID=your-client-id-here
GRAPH_CLIENT_SECRET=your-client-secret-here
# Optional: For SharePoint-based conversion (leave empty for OneDrive)
GRAPH_SITE_ID=
GRAPH_DRIVE_ID=

# Azure Blob Storage (for PDF storage)
AZURE_STORAGE_CONNECTION_STRING=your-connection-string-here
AZURE_STORAGE_CONTAINER_NAME=pdf-documents
STORAGE_TYPE=blob

# ======================================
# Plan A Email Integration (Recommended Architecture)
# ======================================

# Primary Email Provider: SendGrid (Enterprise-grade)
# Get API key from: https://app.sendgrid.com/settings/api_keys
# Setup guide: https://docs.sendgrid.com/for-developers/sending-email/api-getting-started
SENDGRID_API_KEY=SG.your_sendgrid_api_key_here
# Email sender address (must be verified domain in SendGrid)
EMAIL_FROM=DFSA PDF Service <noreply@dfsa.ae>

# Fallback Email Provider: Amazon SES (Optional but Recommended)
# Required if you want automatic fallback when SendGrid fails
# Get credentials from AWS IAM: https://console.aws.amazon.com/iam/
AWS_SES_REGION=us-east-1
AWS_SES_ACCESS_KEY_ID=your_aws_access_key_id_here
AWS_SES_SECRET_ACCESS_KEY=your_aws_secret_access_key_here
